- block:
    - name: configure default security group to allow ssh 
      os_security_group_rule:
        auth: "{{ vars['os_auth_hailstorm_' + item.replace('-','_')] }}"
        security_group: default
        protocol: "tcp"
        port_range_min: 22
        port_range_max: 22
        validate_certs: False
      with_items: "{{ osp_projects }}"
    - name: configure default security group to allow icmp
      os_security_group_rule:
        auth: "{{ vars['os_auth_hailstorm_' + item.replace('-','_')] }}"
        security_group: default
        protocol: "icmp"
        validate_certs: False
      with_items: "{{ osp_projects }}"

    - name: create security group webserver in tenant demo-infra
      os_security_group:
        auth: "{{ os_auth_hailstorm_demo_infra }}"
        name: webserver
        validate_certs: False

    - name: allow HTTP in webserver security group
      os_security_group_rule:
        auth: "{{ os_auth_hailstorm_demo_infra }}"
        security_group: webserver 
        protocol: "tcp"
        port_range_min: 80
        port_range_max: 80
        validate_certs: False

    - name: allow HTTPS in webserver security group
      os_security_group_rule:
        auth: "{{ os_auth_hailstorm_demo_infra }}"
        security_group: webserver
        protocol: "tcp"
        port_range_min: 443
        port_range_max: 443
        validate_certs: False



  delegate_to: localhost
